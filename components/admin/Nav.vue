<template>
  <nav class="fixed w-[calc(100%)] pe-2 z-20 bg-white">
    <div class="flex h-20 border-b border-[#E6E5E4]">
      <div class="aside-nav bg-white transition-all h-full border-r">
        <!-- logo -->
        <div class="relative flex justify-between px-3 items-center py-2">
          <svg
            @click="toggleSidebar()"
            v-if="sidebarOpen"
            class=" w-auto max-w-full cursor-pointer"
            width="64"
            height="64"
            viewBox="0 0 64 64"
            fill="#000"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M14.9646 49.1987C14.9646 42.2524 14.9646 35.3681 14.9646 28.3391C15.5321 28.8146 16.0575 29.2281 16.5409 29.6622C18.7266 31.5642 18.7266 31.5642 18.7266 34.4585C18.7266 37.8283 18.7266 41.2187 18.7266 44.5885C18.7266 44.8366 18.7266 45.0847 18.7266 45.3534C18.9368 45.3948 19.0629 45.4154 19.189 45.4154C24.4852 45.4154 29.7814 45.4981 35.0776 45.3534C40.2687 45.2087 44.7663 40.9086 45.1446 36.009C45.586 30.3445 42.0551 25.5896 36.6118 24.5145C35.7501 24.3491 34.8464 24.3078 33.9637 24.2871C30.8532 24.2665 27.7217 24.2871 24.6113 24.2665C23.2662 24.2665 22.4045 23.5842 22.3205 22.5299C22.2364 21.5169 22.8669 20.7106 23.8757 20.5452C24.1909 20.4832 24.5062 20.4832 24.8214 20.4832C28.2892 20.4832 31.7359 20.4212 35.2037 20.5246C42.0762 20.752 48.0239 26.0857 48.9276 32.7219C49.8944 39.7509 45.7751 46.3457 39.0498 48.4131C37.6416 48.8472 36.1284 49.1367 34.6573 49.1367C28.2682 49.2194 21.8581 49.178 15.469 49.178C15.3009 49.2194 15.1748 49.1987 14.9646 49.1987Z"
              fill="#0095FF"
            />
            <path
              d="M42.7696 18.1264C41.8659 18.1264 41.1934 18.1264 40.5208 18.1264C35.2456 18.1264 29.9915 18.1264 24.7163 18.1264C22.2153 18.1264 20.5339 19.4082 20.0926 21.5789C19.5672 24.1217 21.5848 26.5819 24.2119 26.6025C27.5745 26.6232 30.9162 26.6025 34.2789 26.6025C38.8185 26.6025 42.3913 29.7449 42.7066 34.231C43.0428 38.6758 40.1425 42.149 35.75 42.9759C35.5189 43.0173 35.2877 43.0379 35.0565 43.0379C30.6009 43.0379 26.1454 43.0379 21.6899 43.0379C21.5217 43.0379 21.3326 43.0173 21.1224 43.0173C21.1224 41.7148 21.1224 40.4538 21.1224 39.11C21.4377 39.11 21.7529 39.11 22.0682 39.11C26.0193 39.11 29.9915 39.11 33.9426 39.11C36.4226 39.11 38.0829 37.9316 38.6083 35.8849C39.2388 33.4248 37.4944 30.8199 34.9304 30.6959C32.0511 30.5512 29.1718 30.6545 26.2925 30.5925C25.0315 30.5718 23.7495 30.6132 22.5305 30.3651C18.6634 29.6002 15.9523 26.2304 15.9313 22.3851C15.9103 18.6639 18.6214 15.2528 22.3414 14.3845C22.9929 14.2398 23.6864 14.1571 24.359 14.1571C29.0667 14.1157 33.7955 14.1157 38.5032 14.1364C38.8395 14.1364 39.3019 14.1984 39.512 14.4258C40.5839 15.5629 41.6137 16.7619 42.7696 18.1264Z"
              fill="#0095FF"
            />
          </svg>

          <svg
            v-else
            @click="toggleSidebar()"
            class="w-auto max-w-full cursor-pointer"
            width="64"
            height="64"
            viewBox="0 0 64 64"
            fill="#000"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M14.9646 49.1987C14.9646 42.2524 14.9646 35.3681 14.9646 28.3391C15.5321 28.8146 16.0575 29.2281 16.5409 29.6622C18.7266 31.5642 18.7266 31.5642 18.7266 34.4585C18.7266 37.8283 18.7266 41.2187 18.7266 44.5885C18.7266 44.8366 18.7266 45.0847 18.7266 45.3534C18.9368 45.3948 19.0629 45.4154 19.189 45.4154C24.4852 45.4154 29.7814 45.4981 35.0776 45.3534C40.2687 45.2087 44.7663 40.9086 45.1446 36.009C45.586 30.3445 42.0551 25.5896 36.6118 24.5145C35.7501 24.3491 34.8464 24.3078 33.9637 24.2871C30.8532 24.2665 27.7217 24.2871 24.6113 24.2665C23.2662 24.2665 22.4045 23.5842 22.3205 22.5299C22.2364 21.5169 22.8669 20.7106 23.8757 20.5452C24.1909 20.4832 24.5062 20.4832 24.8214 20.4832C28.2892 20.4832 31.7359 20.4212 35.2037 20.5246C42.0762 20.752 48.0239 26.0857 48.9276 32.7219C49.8944 39.7509 45.7751 46.3457 39.0498 48.4131C37.6416 48.8472 36.1284 49.1367 34.6573 49.1367C28.2682 49.2194 21.8581 49.178 15.469 49.178C15.3009 49.2194 15.1748 49.1987 14.9646 49.1987Z"
              fill="#0095FF"
            />
            <path
              d="M42.7696 18.1264C41.8659 18.1264 41.1934 18.1264 40.5208 18.1264C35.2456 18.1264 29.9915 18.1264 24.7163 18.1264C22.2153 18.1264 20.5339 19.4082 20.0926 21.5789C19.5672 24.1217 21.5848 26.5819 24.2119 26.6025C27.5745 26.6232 30.9162 26.6025 34.2789 26.6025C38.8185 26.6025 42.3913 29.7449 42.7066 34.231C43.0428 38.6758 40.1425 42.149 35.75 42.9759C35.5189 43.0173 35.2877 43.0379 35.0565 43.0379C30.6009 43.0379 26.1454 43.0379 21.6899 43.0379C21.5217 43.0379 21.3326 43.0173 21.1224 43.0173C21.1224 41.7148 21.1224 40.4538 21.1224 39.11C21.4377 39.11 21.7529 39.11 22.0682 39.11C26.0193 39.11 29.9915 39.11 33.9426 39.11C36.4226 39.11 38.0829 37.9316 38.6083 35.8849C39.2388 33.4248 37.4944 30.8199 34.9304 30.6959C32.0511 30.5512 29.1718 30.6545 26.2925 30.5925C25.0315 30.5718 23.7495 30.6132 22.5305 30.3651C18.6634 29.6002 15.9523 26.2304 15.9313 22.3851C15.9103 18.6639 18.6214 15.2528 22.3414 14.3845C22.9929 14.2398 23.6864 14.1571 24.359 14.1571C29.0667 14.1157 33.7955 14.1157 38.5032 14.1364C38.8395 14.1364 39.3019 14.1984 39.512 14.4258C40.5839 15.5629 41.6137 16.7619 42.7696 18.1264Z"
              fill="#0095FF"
            />
          </svg>
          <!--   <svg
             v-if="sidebarOpen"
             @click="toggleSidebar()"
             class="cursor-pointer"
             width="28"
             height="28"
             viewBox="0 0 28 28"
             fill="none"
             xmlns="http://www.w3.org/2000/svg"
           >
             <rect x="2" y="2" width="12" height="24" fill="#3CA60F" />
             <rect x="14" y="2" width="12" height="24" fill="white" />
             <rect
               x="1"
               y="1"
               width="26"
               height="26"
               stroke="#171106"
               stroke-width="2"
             />
           </svg> -->
        </div>
      </div>

      <div class="flex items-center justify-between flex-1 ps-6 h-full">
        <div class="breadcrumb">
          <ul class="text-sm">
            <i
              class="fi fi-rr-bars-sort text-xl cursor-pointer"
              @click="toggleSidebar()"
            ></i>
            <p class="md:hidden lg:hidden block">
              <svg
                @click="toggleSidebar()"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g clip-path="url(#clip0_152_8127)">
                  <path
                    d="M1 6H23C23.2652 6 23.5196 5.89464 23.7071 5.7071C23.8946 5.51957 24 5.26521 24 5C24 4.73478 23.8946 4.48043 23.7071 4.29289C23.5196 4.10536 23.2652 4 23 4H1C0.734784 4 0.48043 4.10536 0.292893 4.29289C0.105357 4.48043 0 4.73478 0 5C0 5.26521 0.105357 5.51957 0.292893 5.7071C0.48043 5.89464 0.734784 6 1 6Z"
                    fill="#374957"
                  />
                  <path
                    d="M1 11H15C15.2652 11 15.5196 10.8946 15.7071 10.7071C15.8946 10.5196 16 10.2652 16 10C16 9.73478 15.8946 9.48043 15.7071 9.29289C15.5196 9.10536 15.2652 9 15 9H1C0.734784 9 0.48043 9.10536 0.292893 9.29289C0.105357 9.48043 0 9.73478 0 10C0 10.2652 0.105357 10.5196 0.292893 10.7071C0.48043 10.8946 0.734784 11 1 11Z"
                    fill="#374957"
                  />
                  <path
                    d="M15 19H1C0.734784 19 0.48043 19.1053 0.292893 19.2929C0.105357 19.4804 0 19.7348 0 20C0 20.2652 0.105357 20.5195 0.292893 20.7071C0.48043 20.8946 0.734784 21 1 21H15C15.2652 21 15.5196 20.8946 15.7071 20.7071C15.8946 20.5195 16 20.2652 16 20C16 19.7348 15.8946 19.4804 15.7071 19.2929C15.5196 19.1053 15.2652 19 15 19Z"
                    fill="#374957"
                  />
                  <path
                    d="M23 14H1C0.734784 14 0.48043 14.1054 0.292893 14.2929C0.105357 14.4805 0 14.7348 0 15C0 15.2653 0.105357 15.5196 0.292893 15.7071C0.48043 15.8947 0.734784 16 1 16H23C23.2652 16 23.5196 15.8947 23.7071 15.7071C23.8946 15.5196 24 15.2653 24 15C24 14.7348 23.8946 14.4805 23.7071 14.2929C23.5196 14.1054 23.2652 14 23 14Z"
                    fill="#374957"
                  />
                </g>
                <defs>
                  <clipPath id="clip0_152_8127">
                    <rect width="24" height="24" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </p>
          </ul>
        </div>

        <svg
          v-if="!sidebarOpen"
          class="block lg:hidden md:hidden"
          width="21"
          height="20"
          viewBox="0 0 21 20"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M0.5 19.9971C0.5 16.0369 0.5 12.1121 0.5 8.10483C0.832786 8.37591 1.14092 8.61163 1.42441 8.85914C2.70625 9.94347 2.70625 9.94347 2.70625 11.5935C2.70625 13.5147 2.70625 15.4476 2.70625 17.3687C2.70625 17.5102 2.70625 17.6516 2.70625 17.8048C2.8295 17.8284 2.90346 17.8402 2.97741 17.8402C6.08342 17.8402 9.18942 17.8873 12.2954 17.8048C15.3398 17.7223 17.9774 15.2708 18.1993 12.4775C18.4581 9.24809 16.3875 6.53727 13.1952 5.92439C12.6898 5.8301 12.1598 5.80653 11.6422 5.79474C9.81802 5.78296 7.98153 5.79474 6.15737 5.78296C5.36854 5.78296 4.8632 5.39401 4.8139 4.79292C4.7646 4.2154 5.13436 3.75574 5.72598 3.66145C5.91086 3.62609 6.09574 3.62609 6.28062 3.62609C8.31432 3.62609 10.3357 3.59073 12.3694 3.64966C16.3998 3.77931 19.8879 6.82014 20.4179 10.6035C20.9848 14.6108 18.5691 18.3706 14.6249 19.5492C13.7991 19.7967 12.9117 19.9617 12.0489 19.9617C8.30199 20.0088 4.54274 19.9853 0.79581 19.9853C0.697206 20.0088 0.623254 19.9971 0.5 19.9971Z"
            fill="#0095FF"
          />
          <path
            d="M16.806 2.28247C16.276 2.28247 15.8816 2.28247 15.4872 2.28247C12.3935 2.28247 9.31218 2.28247 6.2185 2.28247C4.75178 2.28247 3.76574 3.01321 3.50691 4.25076C3.19878 5.70045 4.38202 7.10301 5.92269 7.11479C7.89476 7.12658 9.8545 7.11479 11.8266 7.11479C14.4889 7.11479 16.5842 8.90629 16.7691 11.4639C16.9663 13.9979 15.2654 15.978 12.6894 16.4494C12.5538 16.473 12.4182 16.4848 12.2826 16.4848C9.66962 16.4848 7.05663 16.4848 4.44364 16.4848C4.34504 16.4848 4.23411 16.473 4.11086 16.473C4.11086 15.7305 4.11086 15.0115 4.11086 14.2454C4.29574 14.2454 4.48062 14.2454 4.6655 14.2454C6.98268 14.2454 9.31218 14.2454 11.6294 14.2454C13.0838 14.2454 14.0575 13.5736 14.3656 12.4068C14.7354 11.0042 13.7124 9.51917 12.2087 9.44845C10.5201 9.36595 8.83149 9.42488 7.14291 9.38952C6.40338 9.37773 5.65153 9.40131 4.93666 9.25987C2.66878 8.82378 1.0788 6.90264 1.06648 4.71042C1.05415 2.58891 2.64413 0.644194 4.82573 0.149176C5.20782 0.0666725 5.61456 0.0195279 6.00897 0.0195279C8.76987 -0.00404437 11.5431 -0.00404437 14.304 0.00774179C14.5012 0.00774179 14.7723 0.0431002 14.8956 0.172748C15.5242 0.820986 16.1281 1.50458 16.806 2.28247Z"
            fill="#0095FF"
          />
        </svg>

        <div class="inline-flex items-center px-6" v-if="user">
          <slot />
          <NuxtLink to="/dashboard">
            <img
              :src="user.image"
              class="lg:hidden md:hidden w-[30px] object-cover aspect-square rounded-full"
              alt=""
            />
          </NuxtLink>
        </div>
      </div>
      <HeadlessMenu
        as="div"
        class="relative inline-block text-left dropdown mx-2"
      >
        <HeadlessMenuButton
          type="button"
          class="flex items-center gap-1.5 xl:gap-2 mt-5"
        >
          <!--  <NuxtLink :to="'/dashboard/profile/' + user.id"> -->
          <img :src="user?.image" alt="" class="w-8 h-8 rounded-full" />
          <!--  </NuxtLink> -->
          <div>
            <p class="text-[#4C4C4C] font-medium font-primary text-base">
              {{ user?.first_name }} {{ user?.last_name }}
            </p>
            <p class="font-primary font-light text-[13px] text-[#6E7A84]">
              {{ user?.job_title }}
            </p>
          </div>
          <i class="fi fi-rr-angle-small-down"></i>
        </HeadlessMenuButton>
        <transition
          enter-active-class="transition duration-100 ease-out"
          enter-from-class="transform scale-95 opacity-0"
          enter-to-class="transform scale-100 opacity-100"
          leave-active-class="transition duration-75 ease-in"
          leave-from-class="transform scale-100 opacity-100"
          leave-to-class="transform scale-95 opacity-0"
        >
          <HeadlessMenuItems
            as="ul"
            class="absolute right-0 mt-6 w-48 rounded-md bg-white dark:bg-[#282828] shadow-2xl shadow-zinc-300 ring-1 ring-black/5 dark:shadow-zinc-800 focus:outline-none dark:border dark:border-[#ffffff1a]"
          >
            <li class="dropdown-item !py-3 !pt-4">
              <div class="flex items-start">
                <div class="flex-none px-2">
                  <img :src="user?.image" alt="" class="w-7 h-7 rounded-full" />
                </div>
                <div class="pl-2">
                  <h4
                    class="text-sm text-black dark:text-white font-medium leading-none"
                  >
                    {{ user?.first_name }}
                  </h4>

                  <a
                    class="text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white text-xs whitespace-nowrap text-ellipsis w-full overflow-hidden max-w-[140px] block"
                    :href="`mailto:${user?.job_title}`"
                    >{{ user?.job_title }}</a
                  >
                </div>
              </div>
            </li>
            <li class="h-px bg-black/5 block my-1"></li>
            <li class="flex items-center gap-1 justify-between px-2">
              <a
                @click="logOut"
                href="javaScript:;"
                class="text-danger flex w-full p-2 i tems-center gap-2 transition-colors rounded-md"
              >
                <i class="fi fi-rr-sign-out-alt !text-sm pt-1"></i>
                <span> Log Out </span>
              </a>
            </li>
          </HeadlessMenuItems>
        </transition>
      </HeadlessMenu>
    </div>
  </nav>
</template>

<script setup>
import { useUserStore } from "~/stores/auth";
import { useSettingsStore } from "~/stores/settings";
const { user } = storeToRefs(useUserStore());
const { sidebarOpen } = storeToRefs(useSettingsStore());
const { toggleSidebar, closeSidebar } = useSettingsStore();
const { signOut } = useUserStore();
async function logOut() {
  signOut();
}
</script>
<style lang="scss">
.aside-nav {
  width: 180px;
 
}
</style>
